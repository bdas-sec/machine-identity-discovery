title: "NHI: Azure Storage Connection String Detected"
id: e56ef6fe-72fe-4488-9e9f-b617ba9d7dc7
related:
    - id: "100906"
      type: derived
status: test
description: |
    Detects Azure Storage connection strings containing account names and keys.
    These connection strings provide full read/write access to Azure Storage
    accounts (blobs, queues, tables, files).
    Derived from Wazuh rule 100906.
references:
    - https://attack.mitre.org/techniques/T1552/001/
    - https://learn.microsoft.com/en-us/azure/storage/common/storage-configure-connection-string
author: Bodhisattva Das
date: 2026-02-15
tags:
    - attack.credential_access
    - attack.t1552.001
    - nhi.secret_detection
logsource:
    category: file_access
    product: linux
detection:
    selection:
        Contents|re: 'DefaultEndpointsProtocol=https;AccountName=[^;]+;AccountKey=[^;]+'
    condition: selection
falsepositives:
    - Azure documentation examples
    - Development environment configurations
level: high
