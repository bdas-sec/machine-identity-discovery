title: "NHI: Private Key Detected in File or Output"
id: 3bc33aea-1e77-4708-9c4b-ff849468265d
related:
    - id: "100904"
      type: derived
status: test
description: |
    Detects PEM-encoded private key material (-----BEGIN ... PRIVATE KEY-----)
    appearing in file contents or log output. Private keys exposed in logs or
    accessible files enable authentication impersonation and data decryption.
    Derived from Wazuh rule 100904.
references:
    - https://attack.mitre.org/techniques/T1552/004/
author: Bodhisattva Das
date: 2026-02-15
tags:
    - attack.credential_access
    - attack.t1552.004
    - nhi.secret_detection
logsource:
    category: file_access
    product: linux
detection:
    selection:
        Contents|contains|all:
            - '-----BEGIN'
            - 'PRIVATE KEY-----'
    condition: selection
falsepositives:
    - Certificate management tools generating or rotating keys
    - TLS configuration processes
level: high
