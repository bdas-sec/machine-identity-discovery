title: "NHI: AI Agent Accessing Credential/Config File"
id: 9ad9163e-062e-487d-9942-f0695fd7a309
related:
    - id: "100851"
      type: derived
status: test
description: |
    Detects AI agent framework processes accessing credential and configuration
    files with expanded coverage for cloud provider configs, SSH keys, MCP tool
    configs, service account JSONs, and certificate files (.p12, .pfx).
    Derived from Wazuh rule 100851 (production-grade).
references:
    - https://attack.mitre.org/techniques/T1552/001/
    - https://attack.mitre.org/techniques/T1552/004/
    - https://owasp.org/www-project-top-10-for-large-language-model-applications/
author: Bodhisattva Das
date: 2026-02-15
modified: 2026-02-16
tags:
    - attack.credential_access
    - attack.t1552.001
    - attack.t1552.004
    - nhi.ai_agent
logsource:
    category: file_access
    product: linux
detection:
    selection_process:
        Image|endswith:
            - '/python'
            - '/python3'
            - '/node'
        Image|contains:
            - 'langchain'
            - 'autogen'
            - 'crewai'
            - 'agent'
            - 'llama'
            - 'vllm'
            - 'ollama'
    selection_credential_files:
        TargetFilename|endswith:
            - '.env'
            - '.aws/credentials'
            - '.aws/config'
            - '.kube/config'
            - '.vault-token'
            - '.npmrc'
            - '.docker/config.json'
            - '.git-credentials'
            - 'id_rsa'
            - 'id_ed25519'
            - '.pem'
            - '.key'
            - '.p12'
            - '.pfx'
    selection_credential_patterns:
        TargetFilename|contains:
            - 'service_account'
            - 'service-account'
            - '.mcp/'
            - 'tool_config'
            - 'tool-config'
    condition: 1 of selection_process and (selection_credential_files or selection_credential_patterns)
falsepositives:
    - Python applications loading .env configuration at startup
    - Node.js applications reading .env files via dotenv
level: high
