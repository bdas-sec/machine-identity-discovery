title: "NHI: AI Agent Framework Spawning Shell Subprocess"
id: 230c7675-f325-4142-9316-98dd6ae60453
related:
    - id: "100850"
      type: derived
status: test
description: |
    Detects AI agent framework processes (LangChain, AutoGen, CrewAI, Ollama,
    vLLM, or generic python/node agents) spawning shell subprocesses. Agentic
    AI frameworks that execute arbitrary shell commands represent a significant
    risk of command injection and uncontrolled system access.
    Derived from Wazuh rule 100850 (production-grade).
references:
    - https://attack.mitre.org/techniques/T1059/
    - https://attack.mitre.org/techniques/T1059/004/
    - https://owasp.org/www-project-top-10-for-large-language-model-applications/
author: Bodhisattva Das
date: 2026-02-15
modified: 2026-02-16
tags:
    - attack.execution
    - attack.t1059
    - attack.t1059.004
    - nhi.ai_agent
logsource:
    category: process_creation
    product: linux
detection:
    selection_parent:
        ParentImage|endswith:
            - '/python'
            - '/python3'
            - '/node'
        ParentImage|contains:
            - 'langchain'
            - 'autogen'
            - 'crewai'
            - 'agent'
            - 'llama'
            - 'vllm'
            - 'ollama'
    selection_shell:
        Image|endswith:
            - '/bash'
            - '/sh'
            - '/zsh'
            - '/dash'
            - '/cmd'
            - '/powershell'
            - '/pwsh'
    condition: 1 of selection_parent and selection_shell
falsepositives:
    - Legitimate Python/Node.js applications using subprocess
    - Build tools executing shell commands
    - Jupyter notebook cell execution
level: high
