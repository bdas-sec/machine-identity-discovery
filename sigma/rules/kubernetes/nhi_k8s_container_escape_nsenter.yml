title: "NHI: Container Escape via nsenter Namespace Entry"
id: d76d9ef2-e1a3-442a-8daf-7c9ba575d72b
related:
    - id: "100757"
      type: derived
status: test
description: |
    Detects use of nsenter with namespace flags (--target, --mount, --pid,
    --net, --uts, --ipc) indicating a container escape attempt. nsenter is
    the most common tool for entering host namespaces from a privileged
    container.
    Derived from Wazuh rule 100757.
references:
    - https://attack.mitre.org/techniques/T1611/
    - https://man7.org/linux/man-pages/man1/nsenter.1.html
    - https://blog.trailofbits.com/2019/07/19/understanding-docker-container-escapes/
author: Bodhisattva Das
date: 2026-02-16
tags:
    - attack.privilege_escalation
    - attack.t1611
    - nhi.kubernetes
logsource:
    category: process_creation
    product: linux
detection:
    selection_binary:
        Image|endswith: '/nsenter'
    selection_cmdline:
        CommandLine|contains:
            - '--target'
            - '--mount'
            - '--pid'
            - '--net'
            - '--uts'
            - '--ipc'
    condition: selection_binary and 1 of selection_cmdline
falsepositives:
    - Legitimate container orchestration tools
    - Node maintenance scripts using nsenter for debugging
level: critical
