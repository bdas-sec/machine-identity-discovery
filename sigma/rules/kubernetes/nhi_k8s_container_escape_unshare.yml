title: "NHI: Namespace Manipulation via unshare - Container Escape"
id: 8f108b07-7d38-46f7-b337-d9434783ee66
related:
    - id: "100759"
      type: derived
status: test
description: |
    Detects use of the unshare command with namespace flags, indicating
    potential namespace manipulation for container escape or privilege
    escalation within Kubernetes.
    Derived from Wazuh rule 100759.
references:
    - https://attack.mitre.org/techniques/T1611/
    - https://man7.org/linux/man-pages/man1/unshare.1.html
author: Bodhisattva Das
date: 2026-02-16
tags:
    - attack.privilege_escalation
    - attack.t1611
    - attack.t1055
    - nhi.kubernetes
logsource:
    category: process_creation
    product: linux
detection:
    selection_binary:
        Image|endswith: '/unshare'
    selection_flags:
        CommandLine|contains:
            - '--mount'
            - '--user'
            - '--pid'
            - '--net'
            - '--uts'
            - '--ipc'
            - '--cgroup'
    condition: selection_binary and 1 of selection_flags
falsepositives:
    - Container runtimes creating new namespaces
    - Flatpak/Snap sandbox creation
level: high
