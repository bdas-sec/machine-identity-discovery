title: "NHI: Kubernetes Secrets Enumeration via kubectl"
id: 075d4876-44e2-4fe1-80a1-4ff7da21e3c8
related:
    - id: "100753"
      type: derived
status: test
description: |
    Detects the use of 'kubectl get secrets' to enumerate Kubernetes secrets.
    This is a high-confidence indicator of credential theft attempts within
    a cluster, as legitimate applications access secrets via mounted volumes.
    Derived from Wazuh rule 100753.
references:
    - https://attack.mitre.org/techniques/T1552/007/
author: Bodhisattva Das
date: 2026-02-15
tags:
    - attack.credential_access
    - attack.t1552.007
    - nhi.kubernetes
logsource:
    category: process_creation
    product: linux
detection:
    selection:
        CommandLine|contains|all:
            - 'kubectl'
            - 'get secrets'
    condition: selection
falsepositives:
    - Kubernetes administrators performing routine checks
    - Backup tools reading secret metadata
level: high
