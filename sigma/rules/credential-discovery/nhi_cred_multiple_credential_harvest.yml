title: "NHI: Multiple Credential File Accesses - Credential Harvesting"
id: e0baacd3-e10d-4fd9-b99a-6bdfac10a6e3
related:
    - id: "100609"
      type: derived
name: nhi_credential_harvest
type: correlation
status: test
description: |
    Detects when the same user accesses multiple different credential files
    within a short time window, indicating systematic credential harvesting.
    This is a strong indicator of post-compromise lateral movement preparation.
    Derived from Wazuh rule 100609 (frequency=5, timeframe=60s, same srcuser).
references:
    - https://attack.mitre.org/techniques/T1552/
    - https://attack.mitre.org/techniques/T1083/
author: Bodhisattva Das
date: 2026-02-15
tags:
    - attack.credential_access
    - attack.discovery
    - attack.t1552
    - attack.t1083
    - nhi.credential_discovery
rules:
    - nhi_cred_aws_credentials_access
    - nhi_cred_ssh_private_key_access
    - nhi_cred_git_credential_access
    - nhi_cred_docker_config_access
group-by:
    - User
timespan: 1m
condition:
    gte: 5
level: critical
