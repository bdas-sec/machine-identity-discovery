title: "NHI: K8s Token Theft Followed by Secrets Enumeration - Container Attack"
id: 444b6b44-2bef-4633-9299-08c110a65e24
related:
    - id: "100951"
      type: derived
name: nhi_corr_k8s_attack_chain
type: correlation
status: test
description: |
    Detects when Kubernetes ServiceAccount token access is followed by secrets
    enumeration within 180 seconds. This attack chain indicates an attacker
    stealing the pod's SA token and immediately using it to extract cluster
    secrets via the Kubernetes API.
    Derived from Wazuh rule 100951 (timeframe=180s).
references:
    - https://attack.mitre.org/techniques/T1552/007/
    - https://attack.mitre.org/techniques/T1610/
author: Bodhisattva Das
date: 2026-02-15
tags:
    - attack.credential_access
    - attack.t1552.007
    - attack.t1610
    - nhi.correlation
rules:
    - nhi_k8s_sa_token_access
    - nhi_k8s_secrets_enumeration
group-by:
    - SourceIP
timespan: 3m
condition:
    gte: 1
level: critical
